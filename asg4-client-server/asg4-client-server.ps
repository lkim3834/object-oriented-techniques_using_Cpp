%!PS-Adobe-3.0
%%Creator: groff version 1.22.2
%%CreationDate: Thu May  6 13:14:30 2021
%%Title: asg4-client-server.ps
%%BoundingBox: 0 0 612 792
%%DocumentNeededResources: font Courier
%%+ font Courier-Bold
%%+ font NewCenturySchlbk-Bold
%%+ font NewCenturySchlbk-Roman
%%+ font NewCenturySchlbk-Italic
%%+ font Symbol
%%+ font NewCenturySchlbk-BoldItalic
%%DocumentSuppliedResources: procset grops 1.22 2
%%+ font Courier-Elite-Bold
%%+ font Courier-Elite
%%Pages: 5
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.22 2
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Courier
%%IncludeResource: font Courier-Bold
%%IncludeResource: font NewCenturySchlbk-Bold
%%IncludeResource: font NewCenturySchlbk-Roman
%%IncludeResource: font NewCenturySchlbk-Italic
%%IncludeResource: font Symbol
%%IncludeResource: font NewCenturySchlbk-BoldItalic
%%BeginResource: font Courier-Elite-Bold
%%DocumentNeededResources: font Courier-Bold
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite-Bold
[ .833333333 0 0 1 0 0 ]
/Courier-Bold
MakeTransformedFont
%%EndResource
%%BeginResource: font Courier-Elite
%%DocumentNeededResources: font Courier
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite
[ .833333333 0 0 1 0 0 ]
/Courier
MakeTransformedFont
%%EndResource
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/NewCenturySchlbk-BoldItalic@0 ENC0/NewCenturySchlbk-BoldItalic RE
/NewCenturySchlbk-Italic@0 ENC0/NewCenturySchlbk-Italic RE
/Courier-Elite-Bold@0 ENC0/Courier-Elite-Bold RE/Courier-Elite@0 ENC0
/Courier-Elite RE/NewCenturySchlbk-Roman@0 ENC0/NewCenturySchlbk-Roman
RE/NewCenturySchlbk-Bold@0 ENC0/NewCenturySchlbk-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CSE-111 \203 Spring 2021 \203 Program 4 \203 Client/Server and Sockets)
72 50 Q/F1 12/NewCenturySchlbk-Roman@0 SF 3.336(1o)44.148 G 3.336(f5)
-3.336 G/F2 11/Courier-Elite@0 SF
($Id: asg4-client-server.mm,v 1.30 2021-05-06 13:14:29-07 - - $)72 67 Q
(PWD: /afs/cats.ucsc.edu/courses/cse111-wm/Assignments/asg4-client-serv\
er)72 80 Q(URL: https://www2.ucsc.edu/courses/cse111-wm/:/Assignments/a\
sg4-client-server/)72 93 Q F0 3.444(1. Overview)72 117 R F1 2.531
(This project will implement a c)72 137 R 2.531
(lient/server application using soc)-.084 F(kets)-.084 E 9.202(.A)-.3 G
(daemon)-3.336 E(\()72 151 Q/F3 12/Courier-Elite-Bold@0 SF(cxid)A F1
3.955(\)l)C .619(istens on a soc)-3.955 F .619(ket for c)-.084 F .619
(lient connection requests)-.084 F 7.291(.E)-.3 G(ac)-7.291 E 3.955(hc)
-.084 G .619(onnection will cause)-3.955 F .204(the server to fork a c)
72 165 R .203(hild process to serve the c)-.084 F 3.539(lient. The)-.084
F .203(daemon runs in an in\214nite)3.539 F .489(loop listening)72 179 R
7.161(.T)-.3 G .489(he server exits when the c)-7.161 F .489
(lient disconnects)-.084 F 7.161(.A)-.3 G -.084(cl)-3.336 G .489
(ient \().084 F F3(cxi)A F1 3.825(\)c)C(onnects)-3.825 E 1.673
(to a server and can send \214les)72 193 R 5.009(,r)-.3 G 1.673
(eceive \214les)-5.009 F 5.008(,a)-.3 G 1.672
(nd get a summary listing of all \214les)-5.008 F(present.)72 207 Q
4.589(As)72 227 S(oc)-4.589 E 1.253(ket is a two-w)-.084 F 1.493 -.12
(ay m)-.216 H 1.254(eans of communication between processes).12 F 4.59
(,n)-.3 G 1.254(ot necessarily)-4.59 F 2.195(running on the same host.)
72 241 R 2.194(An IPv4 host is know by a 4-octet sequence suc)8.867 F
5.53(ha)-.084 G(s)-5.53 E .876(128.114.108.152, and a port is an unsign\
ed 16-bit number \(0 to 65535\).)72 255 R(Communi-)7.548 E
(cation will be done via TCP/IP over IPv4 soc)72 269 Q(kets)-.084 E(.)
-.3 E F0 3.444(2. Programs)72 295 R F1 2.65(In this project, two main p\
rograms are to be written for the three parts of the)72 315 R -1.336
(project :)72 329 R 1.29(the daemon and server)7.962 F 4.627(,a)-1.2 G
1.291(nd the c)-4.627 F 4.627(lient. There)-.084 F 1.291
(will also be several library)4.627 F
(\214les written to be used by the programs)72 343 Q 6.672(.T)-.3 G
(he general function is similar to)-6.672 E F3(sftp)3.336 E F1(\(1\).)A
F3(cxid)72 363 Q F1 -1.336(Usage :)102 377 R F3(cxid)6.672 E/F4 12
/NewCenturySchlbk-Italic@0 SF(port)5.336 E F1 .104(Creates a server soc)
102 397 R .104(ket and goes into an in\214nite loop)-.084 F 6.776(:W)2 G
.104(hen it accepts a c)-6.776 F(lient)-.084 E(soc)102 411 Q 1.067
(ket, it uses)-.084 F F3(fork)4.403 E F1 1.067(\(2\) to create a c)B
1.067(hild process)-.084 F 4.403(,w)-.3 G(hic)-4.403 E 4.403(hf)-.084 G
1.067(unctions as the server)-4.403 F 2.127(to communicate with the c)
102 425 R 5.462(lient. The)-.084 F 2.126
(daemon listens for connections on the)5.462 F(given port.)102 439 Q
1.363(The server is forked with an open soc)102 459 R 1.363
(ket communicating with the c)-.084 F 4.699(lient. Its)-.084 F 1.157
(loop repeatedly reads commands and information from the c)102 473 R
1.156(lient and acts on)-.084 F 1.46(those commands)102 487 R 4.796(,r)
-.3 G 1.46(eturning information bac)-4.796 F 4.796(kt)-.084 G 4.796(ot)
-4.796 G 1.46(he c)-4.796 F 4.796(lient. Its)-.084 F 1.46
(loop will be a)4.796 F 1.992
(receive followed by a send, responding to c)102 501 R 1.992
(lient requests)-.084 F 8.664(.I)-.3 G 5.328(te)-8.664 G 1.992
(xits when the)-5.328 F -.084(cl)102 515 S(ient c).084 E(loses the soc)
-.084 E 3.336(ket. It)-.084 F
(does no terminal I/O except for debugging purposes)3.336 E(.)-.3 E F3
(cxi)72 535 Q F1 -1.336(Usage :)102 549 R F3(cxi)6.672 E F4 2(host port)
5.336 F F1 .901(The c)102 569 R .901(lient interacts with the user)-.084
F 7.573(.C)-1.2 G .901(ommands are read from the terminal \(or)-7.573 F
1.054(redirect\), eac)102 583 R 4.39(ho)-.084 G 4.39(fw)-4.39 G(hic)
-4.39 E 4.389(hi)-.084 G 4.389(se)-4.389 G 1.053
(xecuted one at a time by communicating with the)-4.389 F(server)102 597
Q 7.304(.R)-1.2 G .632(esults are then displa)-7.304 F .632
(yed at the terminal.)-.12 F .632(The c)7.304 F .632
(lient connects to the)-.084 F(given host and port.)102 611 Q F0 3.444
(3. Interactive)72 637 R(Commands)3.444 E F1(The)72 657 Q F3(cxi)3.478 E
F1 -.084(cl)3.478 G .141(ient responds to commands read from the standa\
rd output and writes out-).084 F 3.417
(put to the standard output and error and accesses \214les)72 671 R
10.089(.I)-.3 G 6.754(nt)-10.089 G 3.418(he syntax below)-6.754 F(,)-1.5
E F3 .653(Courier Bold)72 685 R F1 .653(are literal c)3.989 F .653
(haracters actually typed in, while)-.084 F F4 .653(Roman Italic)3.989 F
F1 .653(stands for)3.989 F(appropriate substitutions)72 699 Q(.)-.3 E 0
Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CSE-111 \203 Spring 2021 \203 Program 4 \203 Client/Server and Sockets)
72 50 Q/F1 12/NewCenturySchlbk-Roman@0 SF 3.336(2o)44.148 G 3.336(f5)
-3.336 G/F2 12/Courier-Elite-Bold@0 SF(exit)72 74 Q F1
(Quit the program.)102 88 Q
(An end of \214le marker or Control/D is equivalent.)6.672 E F2(get)72
108 Q/F3 12/NewCenturySchlbk-Italic@0 SF(\214lename)6 E F1 1.282
(Copy the \214le named)102 122 R F3(\214lename)4.618 E F1 1.282
(on the remote server and create or overwrite a)4.618 F
(\214le of the same name in the current directory)102 136 Q(.)-1.5 E F2
(help)72 156 Q F1 3.336(As)102 170 S(ummary of a)-3.336 E
(vailable commands is printed.)-.12 E F2(ls)72 190 Q F1 .273
(Causes the remote server to execute the command)102 204 R F2 .272
(ls -l)3.608 F F1 .272(and prints the output)3.608 F(to the user')102
218 Q 3.336(st)-.3 G(erminal.)-3.336 E F2(put)72 238 Q F3(\214lename)6 E
F1 1.003(Copies a local \214le into the soc)102 252 R 1.003
(ket and causes the remote server to create that)-.084 F
(\214le in its directory)102 266 Q(.)-1.5 E F2(rm)72 286 Q F3
(\214lename)6 E F1(Causes the remote server to remove the \214le)102 300
Q(.)-.216 E F0 3.444(4. Protocol)72 326 R(used by the)3.444 E F2(cxi*)
3.444 E F0(programs)3.444 E F1 -.66(Fo)72 346 S 4.165(rt).66 G .829
(he c)-4.165 F .829(lient and server to communicate)-.084 F 4.165(,ap)
-.216 G .829(rotocol needs to be established.)-4.165 F(Eac)7.5 E(h)-.084
E 1.471(message must be framed in terms of a header and a pa)72 360 R
4.807(yload. The)-.12 F 1.471(header alw)4.807 F -.12(ay)-.216 G(s).12 E
.389(consists of a)72 374 R F2(struct)3.725 E F1 .388(of size 64 bytes)
3.725 F 7.06(.A)-.3 G .388(ll messages between c)-7.06 F .388
(lient and server consist)-.084 F 3.052(of these 64 bytes)72 388 R 6.388
(,p)-.3 G 3.052(ossibly followed by a pa)-6.388 F 6.388(yload. F)-.12 F
3.052(or alignment purposes)-.66 F 6.388(,t)-.3 G(he)-6.388 E F2(nbytes)
72 402 Q F1(\214eld is \214rst.)3.336 E
(Before \214lling in the \214elds)6.672 E 3.336(,u)-.3 G(se)-3.336 E F2
(memset)3.336 E F1(\(3\) to c)A(lear the struct.)-.084 E F2
(enum class cxi_command : uint8_t {)102 422 Q
(ERROR = 0, EXIT, GET, HELP, LS, PUT, RM, FILEOUT, LSOUT, ACK, NAK)120
436 Q(};)102 450 Q(size_t constexpr FILENAME_SIZE = 59;)102 464 Q
(struct cxi_header {)102 478 Q(uint32_t nbytes {0};)120 492 Q
(cxi_command command {cxi_command::ERROR};)120 506 Q
(char filename[FILENAME_SIZE] {};)120 520 Q(};)102 534 Q F1
(The purposes of the \214elds are as follows)72 554 Q(:)2 E F2
(uint32_t nbytes;)72 574 Q F1 .298(The number of bytes in the pa)102 588
R .297(yload if there is any pa)-.12 F 3.633(yload. Otherwise)-.12 F
.297(it must)3.633 F 1.39(be zero \(MBZ\).)102 602 R 1.39
(This \214eld is sent in network byte order and so must use the)8.062 F
(functions)102 616 Q F2(ntohl)3.336 E F1(\(3\) and)A F2(htonl)3.336 E F1
(\(3\) when loading and storing data.)A F2(cxi_command command;)72 636 Q
F1 4.116(As)102 650 S .78(ingle byte containing one of the)-4.116 F F2
(cxi_command)4.116 E F1(constants)4.116 E 7.452(.N)-.3 G .78
(ote that the)-7.452 F F2(enum)4.116 E F1(is speci\214cally a)102 664 Q
F2(uint8_t)3.336 E F1(single byte type)3.336 E(.)-.216 E F2
(char filename[59];)72 684 Q F1 .135
(The name of the \214le being transferred or removed.)102 698 R .135
(The \214lename ma)6.807 F 3.471(yn)-.12 G .135(ot ha)-3.471 F(ve)-.12 E
1.244(any slash \()102 712 R F2('/')A F1 4.58(\)c)C 1.244
(haracters in it and must be null-terminated \(with)-4.664 F F2('\\0')
4.58 E F1 4.58(\). All)B 1.344
(bytes following the null must also be null.)102 726 R -.444(Pa)8.016 G
1.344(thnames with slashes and \214le-).444 F(names longer than 58 c)102
740 Q(haracters are prohibited.)-.084 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CSE-111 \203 Spring 2021 \203 Program 4 \203 Client/Server and Sockets)
72 50 Q/F1 12/NewCenturySchlbk-Roman@0 SF 3.336(3o)44.148 G 3.336(f5)
-3.336 G -.66(Fo)72 74 S .654(llowing are the meanings of eac).66 F 3.99
(ho)-.084 G 3.99(ft)-3.99 G(he)-3.99 E/F2 12/Courier-Elite-Bold@0 SF
(cxi_command)3.989 E F1(values)3.989 E 7.325(.E)-.3 G(ac)-7.325 E 3.989
(hi)-.084 G 3.989(se)-3.989 G .653(ither c)-3.989 F(lient)-.084 E
(to server \(C)72 88 Q/F3 12/Symbol SF<ae>A F1(S\) or server to c)A
(lient \(S)-.084 E F3<ae>A F1(C\), but never both.)A F2
(cxi_command::ERROR)72 108 Q F1
(An error \215ag to indicate an invalid header)102 122 Q 6.672(.U)-1.2 G
(sed internally)-6.672 E(.)-1.5 E F2(cxi_command::EXIT)72 142 Q F1
(Internal to)102 156 Q F2(cxi)3.336 E F1 3.336(,n)C
(ot used in communication.)-3.336 E F2(cxi_command::GET)72 176 Q F1(\(C)
6 E F3<ae>A F1(S\))A .425(Request a \214le from the server)102 190 R
7.097(.T)-1.2 G .426(he \214lename is used both remotely and locally)
-7.097 F(.)-1.5 E(The pa)102 204 Q(yload length is 0.)-.12 E F2
(cxi_command::HELP)72 224 Q F1(Internal to)102 238 Q F2(cxi)3.336 E F1
3.336(,n)C(ot used in communication.)-3.336 E F2(cxi_command::LS)72 258
Q F1(\(C)6 E F3<ae>A F1(S\))A(Request \214le \()102 272 Q F2(ls)A F1
3.336(\)i)C 3.336(nformation. The)-3.336 F(pa)3.336 E
(yload length and \214lename are zeroed.)-.12 E F2(cxi_command::PUT)72
292 Q F1(\(C)6 E F3<ae>A F1(S\))A 1.264(The length of the pa)102 306 R
1.263(yload is the number of bytes in the \214le)-.12 F 7.935(.T)-.216 G
1.263(he contents of)-7.935 F 1.013
(the \214le immediately follow the header)102 320 R 7.685(.T)-1.2 G
1.013(he bytes of the pa)-7.685 F 1.013(yload are unstruc-)-.12 F
(tured and ma)102 334 Q 3.336(yc)-.12 G(ontain null bytes)-3.336 E 6.672
(.B)-.3 G(inary \214les are acceptable)-6.672 E(.)-.216 E F2
(cxi_command::RM)72 354 Q F1(\(C)6 E F3<ae>A F1(S\))A
(Request to remove a \214le)102 368 Q 6.672(.T)-.216 G(he pa)-6.672 E
(yload length is 0.)-.12 E F2(cxi_command::FILEOUT)72 388 Q F1(\(S)6 E
F3<ae>A F1(C\))A 1.476(Response to a)102 402 R F2(cxi_command::GET)4.812
E F1 8.148(.T)C 1.476(he \214lename is the same as in the request)-8.148
F 1.449(and the pa)102 416 R 1.449
(yload length re\215ects the number of bytes in the \214le)-.12 F 8.122
(.T)-.216 G 1.45(he pa)-8.122 F(yload)-.12 E
(consists of the bytes of the \214le)102 430 Q(.)-.216 E F2
(cxi_command::LSOUT)72 450 Q F1(\(S)6 E F3<ae>A F1(C\))A .29
(Response to a)102 464 R F2(cxi_command::LS)3.625 E F1 6.961(.T)C .289
(he \214lename is zeroed and the pa)-6.961 F .289(yload length)-.12 F
1.241(is the number of bytes sent in the pa)102 478 R 4.577(yload. The)
-.12 F(pa)4.577 E 1.241(yload is the output of the)-.12 F(command)102
492 Q F2(ls -l)3.336 E F1(.)A F2(cxi_command::ACK)72 512 Q F1(\(S)6 E F3
<ae>A F1(C\))A .086(Response to either a)102 526 R F2(cxi_command::PUT)
3.421 E F1 .085(or a)3.421 F F2(cxi_command::RM)3.421 E F1 .085
(indicating that the)3.421 F(request w)102 540 Q
(as successfully completed.)-.216 E F2(cxi_command::NAK)72 560 Q F1(\(S)
6 E F3<ae>A F1(C\))A .675(Response to any request that fails)102 574 R
7.348(.T)-.3 G .676(here is no pa)-7.348 F 4.012(yload. The)-.12 F .676
(\214lename \214eld is)4.012 F .453(the same as w)102 588 R .452
(as in the original request.)-.216 F .452
(The nbytes \214eld is set to the value of)7.124 F F2(errno)102 602 Q F1
(in the server')3.336 E 3.336(sa)-.3 G(ttempt to preform a task.)-3.336
E F0 3.444(5. Procedures)72 628 R F1(Eac)72 648 Q 3.702(ho)-.084 G 3.702
(ft)-3.702 G .367
(he above commands requires procedures for accessing \214les)-3.702 F
3.703(,i)-.3 G(nc)-3.703 E .367(luding read-)-.084 F .954(ing \214les f\
rom disk and writing \214les to disk, as well as accessing directories)
72 662 R 7.626(.W)-.3 G(hen)-7.626 E 1.678
(any of the system calls fails in the server)72 676 R 5.014(,t)-1.2 G
1.678(he server immediately terminates the)-5.014 F .215
(operation and sends the value of)72 690 R F2(errno)3.55 E F1(bac)3.55 E
3.55(kt)-.084 G 3.55(ot)-3.55 G .214(he c)-3.55 F .214(lient in a)-.084
F F2(cxi_command::NAK)3.55 E F1(mes-)3.55 E(sage)72 704 Q(.)-.216 E 0 Cg
EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CSE-111 \203 Spring 2021 \203 Program 4 \203 Client/Server and Sockets)
72 50 Q/F1 12/NewCenturySchlbk-Roman@0 SF 3.336(4o)44.148 G 3.336(f5)
-3.336 G 2.664(\(a\) F)81.336 74 R .295(or the c)-.66 F .295
(lient or server to send a \214le it must \214rst be read into a buffer)
-.084 F 6.968(.B)-1.2 G(inary)-6.968 E 2.974
(\214les must be properly handled, so protocols whic)102 88 R 6.31(ha)
-.084 G 2.973(ssume text \214les won't)-6.31 F 3.621(work. T)102 102 R
3.621(ol)-.66 G .286(oad a \214le from disk, use)-3.621 F/F2 12
/Courier-Elite-Bold@0 SF(ifstream::read\(\))3.622 E F1 3.622(,c)C .286
(ollecting c)-3.622 F .286(haracters into)-.084 F 4.198(ab)102 116 S
(uffer)-4.198 E 7.534(.R)-1.2 G .862
(ead the entire \214le into a buffer then c)-7.534 F .862(lose it.)-.084
F .861(After that, it ma)7.534 F 4.197(yb)-.12 G(e)-4.197 E
(sent down the soc)102 130 Q(ket.)-.084 E 2.664(\(b\) Alternatively)
81.336 150 R(,)-1.5 E F2(stat)3.97 E F1 .634
(\(2\) the \214le to see how large it is)B 3.971(,a)-.3 G .635
(nd send the \214le down the)-3.971 F(soc)102 164 Q .114(ket piecemeal.)
-.084 F .114(In conjunction with)6.786 F F2(stat)3.45 E F1 .113
(\(2\), it is also possible to ma)B 3.449(yt)-.12 G .113(he \214le)
-3.449 F 4.842(into memory using)102 178 R F2(mmap)8.178 E F1 4.842
(\(2\), provided that the memory thus acquired is)B(released with)102
192 Q F2(munmap)3.336 E F1(\(2\) when the \214le operation is complete)A
(.)-.216 E 2.664(\(c\) When)82.68 212 R 1.284
(receiving a \214le from the soc)4.62 F 1.284
(ket, Receive the header and determine the)-.084 F 2.2
(size of the \214le)102 226 R 8.872(.C)-.216 G 2.2(reate an)-8.872 F F2
(ofstream)5.536 E F1 2.2(and use)5.536 F F2(ofstream::write\(\))5.536 E
F1 2.2(to write the)5.536 F .966
(parts of the \214le as they are received from the soc)102 240 R 4.301
(ket. A)-.084 F .965(C++ stream is c)4.301 F(losed)-.084 E
(when the variable goes out of scope)102 254 Q 3.336(,o)-.216 G 3.336
(ry)-3.336 G(ou can call)-3.336 E F2(close)3.336 E F1(.)A 2.664(\(d\) T)
81.12 274 R 3.336(od)-.66 G(elete a \214le for the)-3.336 E F2
(cxi_command::RM)3.336 E F1(command, use)3.336 E F2(unlink)3.336 E F1
-1.336(\(2\) :)B F2(rc = unlink \(filename\);)115.5 288 Q F1 2.664
(\(e\) T)82.008 308 R 4.155(oe)-.66 G .819(xecute the)-4.155 F F2
(cxi_command::LS)4.155 E F1 .82(command use)4.155 F F2(popen)4.156 E F1
.82(\(2\) and)B F2(pclose)4.156 E F1 .82(\(2\) to create)B 3.336(ap)102
322 S(ipe stream from the)-3.336 E F2(ls)3.336 E F1(\(1\) command)A F2
(FILE* pipe = popen \("ls -l", "r"\);)115.5 336 Q F1 1.084
(Then read the c)102 350 R 1.084
(haracters from the pipe in the easiest w)-.084 F -.12(ay)-.216 G 4.419
(,p)-1.38 G 1.083(robably by using)-4.419 F F2(fgets)102 364 Q F1 3.405
(\(3\). F)B(inally)-.12 E(,)-1.5 E F2(pclose\(pipe\))3.405 E F1 6.741
(.T)C .069(hen send the output bac)-6.741 F 3.405(kt)-.084 G .069(he c)
-3.405 F .069(lient in a)-.084 F F2(cxi_)3.405 E(command::LSOUT)102 378
Q F1(message)3.336 E(.)-.216 E F0 3.444(6. Modules)72 404 R F1 1.46
(There will need to be several modules in this suite of programs)72 424
R 8.132(.E)-.3 G(ac)-8.132 E 4.796(ho)-.084 G 4.796(ft)-4.796 G 1.46
(he pro-)-4.796 F(grams)72 438 Q 3.336(,o)-.3 G 3.336(fc)-3.336 G(ourse)
-3.336 E 3.336(,w)-.216 G(ill ha)-3.336 E
(ve its own source \214le with a main function in it.)-.12 E(The)72 458
Q F2(sockets)3.336 E F1(module will be a useful inc)3.336 E
(lusion into the program as its own module)-.084 E(.)-.216 E .366
(There should also be a)72 478 R F2(cxi_protocol)3.702 E F1 .366
(module to implement the protocols and contain)3.702 F 1.036
(code for accessing \214les and soc)72 492 R(kets)-.084 E 4.371(,s)-.3 G
1.035(ince these will be used by both the c)-4.371 F 1.035(lient and)
-.084 F(the server)72 506 Q(.)-1.2 E F0 3.444(7. Use)72 532 R
(of sockets)3.444 E F1 .726(The sysadmin operating)72 552 R F2
(unix.ucsc.edu)4.062 E F1 .726(has bloc)4.062 F .726
(ked all ports except for the ssh port)-.084 F 1.376
(for security reasons)72 566 R 4.711(,s)-.3 G 4.711(oy)-4.711 G 1.375
(ou will not be able to run the server on one of the Linux)-4.711 F .012
(servers and your c)72 580 R .012(lient on your own mac)-.084 F(hine)
-.084 E 6.684(.W)-.216 G .012(hen testing your program, open two)-6.684
F 1.81(terminals on the)72 594 R/F3 12/NewCenturySchlbk-BoldItalic@0 SF
(same)5.146 E F1 5.146(host. Y)5.146 F 1.81(ou ma)-1.2 F 5.146(yl)-.12 G
1.809(og into any host to run your server)-5.146 F 5.145(,t)-1.2 G(hen)
-5.145 E .732(start it up)72 608 R 7.404(.T)-.216 G .733
(hen, in another window)-7.404 F 4.069(,l)-1.5 G .733
(og into the same host to run the c)-4.069 F 4.069(lient. The)-.084 F
-.084(cl)72 622 S .56
(ient and the server must be run in different directories).084 F 7.231
(.U)-.3 G .559(se the)-7.231 F F2(hostname)3.895 E F1 .559(\(1\) com-)B
(mand to discover whic)72 636 Q 3.336(hh)-.084 G
(ost you are logged into)-3.336 E 6.672(.E)-.216 G -1.336(xample :)
-6.672 F/F4 12/Courier-Elite@0 SF(-bash-71$)85.5 650 Q F2(hostname)6 E
F4(unix2.lt.ucsc.edu)85.5 664 Q F1 .439(The name)72 678 R F2
(unix.ucsc.edu)3.775 E F1 .44(is not actually a real host.)3.775 F .44
(It is just an alias for one of the)7.112 F(real hosts)72 692 Q 3.336
(,w)-.3 G(hic)-3.336 E 3.336(hh)-.084 G -.12(av)-3.336 G 3.336(en).12 G
(ame patterns like the one shown here)-3.336 E(.)-.216 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CSE-111 \203 Spring 2021 \203 Program 4 \203 Client/Server and Sockets)
72 50 Q/F1 12/NewCenturySchlbk-Roman@0 SF 3.336(5o)44.148 G 3.336(f5)
-3.336 G F0 3.444(8. Use)72 74 R(of ports)3.444 E F1 1.142(If your daem\
on listens on a port that has been bound by another process)72 94 R
4.478(,y)-.3 G 1.142(ou will)-4.478 F .022(get the message `)72 108 R
-.888(`A)-.3 G .022(ddress already in use').888 F 3.358('b)-.3 G .023
(ecause only one process at any given time)-3.358 F .479
(is allowed to listen on a particular process)72 122 R 7.15(.T)-.3 G
3.814(oa)-7.81 G .478(void this)-3.934 F 3.814(,c)-.3 G .478
(hoose a port number not)-3.898 F
(being used by anyone else on the same server)72 136 Q(.)-1.2 E -.444
(Po)72 156 S(rt numbers are divided into three ranges).444 E(:)2 E 2.664
(\(a\) P)81.336 176 R 1.178
(orts 0 through 1023 \(0x3FF\) are well known.)-.444 F 1.178
(They are associated with ser)7.85 F(-)-.444 E 2.175
(vices in a static manner and are reserved to privileged processes)102
190 R 8.846(.A)-.3 G 2.174(list of)-3.336 F(these services ma)102 204 Q
3.336(yb)-.12 G 3.336(ef)-3.336 G(ound in the \214le)-3.336 E/F2 12
/Courier-Elite-Bold@0 SF(/etc/services)3.336 E F1(.)A 2.664(\(b\) P)
81.336 224 R 3.647(ort numbers from 1024 \(0x400\) through 49151 \(0xBF\
FF\) are registered.)-.444 F .143(They are used for multiple purposes)
102 238 R 6.815(.C)-.3 G .143(hoose any of these ports for your server)
-6.815 F(if not already in use)102 252 Q(.)-.216 E 2.664(\(c\) Dynamic)
82.68 272 R 3.148
(and private ports are those from 49152 \(0xC000\) through 65535)6.483 F
(\(0xFFFF\) and services should not be associated with them.)102 286 Q
F0 3.444(9. Runaway)72 312 R(Processes)3.444 E F1 1.364
(Be careful in using)72 332 R F2(fork)4.7 E F1 1.363
(\(2\) so that you don't accidentally create a fork-bomb)B 8.035(.T)
-.216 G(he)-8.035 E(command)72 346 Q F2(pkill)4.746 E F1 1.41
(\(1\) can be used to kill all processes matc)B 1.41
(hing a particular pattern.)-.084 F(So the command)72 360 Q F2
(pkill cxi)85.5 374 Q F1 1.425
(will kill all of your processes whose executables contain the string `)
72 388 R(`)-.3 E F2(cxi)A F1 -.3('')C 8.097(.A).3 G(really)-3.336 E
(quic)72 402 Q 3.336(kw)-.084 G .24 -.12(ay t)-3.552 H 3.336(ol).12 G
(og out is to use)-3.336 E F2(kill)3.336 E F1 -1.336(\(1\) :)B F2
(kill -9 -1)85.5 416 Q(kill -s KILL -1)85.5 430 Q F1(will send)72 444 Q
F2(SIGKILL)3.336 E F1(to all of your processes)3.336 E 3.336(,t)-.3 G
(hus logging you out.)-3.336 E F0 3.444(10. What)72 470 R(to Submit)
3.444 E F1(Submit)72 490 Q F2(Makefile)4.165 E F1(whic)4.165 E 4.165(hb)
-.084 G .829(uilds both programs)-4.165 F 4.165(,a)-.3 G .829
(ll necessary C++ header and imple-)-4.165 F .732(mentation \214les)72
504 R 7.404(.A)-.3 G .732(nd if doing pair programming)-7.404 F 4.068
(,t)-.3 G(he)-4.068 E F2(PARTNER)4.068 E F1(\214le)4.068 E 7.404(.W)
-.216 G .732(hen the grader)-7.404 F(uses the command)72 518 Q F2(make)
3.336 E F1(in the submit directory)3.336 E 3.336(,t)-1.5 G
(he both binaries should be built.)-3.336 E 0 Cg EP
%%Trailer
end
%%EOF
